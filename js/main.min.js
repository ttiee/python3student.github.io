document.addEventListener("DOMContentLoaded",(function(){let blogNameWidth,menusWidth,searchWidth,$nav,mobileSidebarOpen=!1;const adjustMenu=init=>{if(init){blogNameWidth=document.getElementById("site-name").offsetWidth;const $menusEle=document.querySelectorAll("#menus .menus_item");menusWidth=0,$menusEle.length&&$menusEle.forEach(i=>{menusWidth+=i.offsetWidth});const $searchEle=document.querySelector("#search-button");searchWidth=$searchEle?$searchEle.offsetWidth:0,$nav=document.getElementById("nav")}let hideMenuIndex="";hideMenuIndex=window.innerWidth<=768||blogNameWidth+menusWidth+searchWidth>$nav.offsetWidth-120,hideMenuIndex?$nav.classList.add("hide-menu"):$nav.classList.remove("hide-menu")},initAdjust=()=>{adjustMenu(!0),$nav.classList.add("show")},sidebarFn_open=()=>{btf.sidebarPaddingR(),document.body.style.overflow="hidden",btf.animateIn(document.getElementById("menu-mask"),"to_show 0.5s"),document.getElementById("sidebar-menus").classList.add("open"),mobileSidebarOpen=!0},sidebarFn_close=()=>{const $body=document.body;$body.style.overflow="",$body.style.paddingRight="",btf.animateOut(document.getElementById("menu-mask"),"to_hide 0.5s"),document.getElementById("sidebar-menus").classList.remove("open"),mobileSidebarOpen=!1},scrollDownInIndex=()=>{const $scrollDownEle=document.getElementById("scroll-down");$scrollDownEle&&$scrollDownEle.addEventListener("click",(function(){btf.scrollToDest(document.getElementById("content-inner").offsetTop,300)}))},addHighlightTool=function(){const highLight=GLOBAL_CONFIG.highlight;if(!highLight)return;const isHighlightCopy=highLight.highlightCopy,isHighlightLang=highLight.highlightLang,isHighlightShrink=GLOBAL_CONFIG_SITE.isHighlightShrink,highlightHeightLimit=highLight.highlightHeightLimit,isShowTool=isHighlightCopy||isHighlightLang||void 0!==isHighlightShrink,$figureHighlight="highlighjs"===highLight.plugin?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if(!isShowTool&&!highlightHeightLimit||!$figureHighlight.length)return;const isPrismjs="prismjs"===highLight.plugin;let highlightShrinkEle="",highlightCopyEle="";const highlightShrinkClass=!0===isHighlightShrink?"closed":"";void 0!==isHighlightShrink&&(highlightShrinkEle=`<i class="fas fa-angle-down expand ${highlightShrinkClass}"></i>`),isHighlightCopy&&(highlightCopyEle='<div class="copy-notice"></div><i class="fas fa-paste copy-button"></i>');const copy=(text,ctx)=>{if(document.queryCommandSupported&&document.queryCommandSupported("copy"))if(document.execCommand("copy"),void 0!==GLOBAL_CONFIG.Snackbar)btf.snackbarShow(GLOBAL_CONFIG.copy.success);else{const prevEle=ctx.previousElementSibling;prevEle.innerText=GLOBAL_CONFIG.copy.success,prevEle.style.opacity=1,setTimeout(()=>{prevEle.style.opacity=0},700)}else void 0!==GLOBAL_CONFIG.Snackbar?btf.snackbarShow(GLOBAL_CONFIG.copy.noSupport):ctx.previousElementSibling.innerText=GLOBAL_CONFIG.copy.noSupport},highlightCopyFn=ele=>{const $buttonParent=ele.parentNode;$buttonParent.classList.add("copy-true");const selection=window.getSelection(),range=document.createRange();isPrismjs?range.selectNodeContents($buttonParent.querySelectorAll("pre code")[0]):range.selectNodeContents($buttonParent.querySelectorAll("table .code pre")[0]),selection.removeAllRanges(),selection.addRange(range);const text=selection.toString();copy(text,ele.lastChild),selection.removeAllRanges(),$buttonParent.classList.remove("copy-true")},highlightShrinkFn=ele=>{const $nextEle=[...ele.parentNode.children].slice(1);ele.firstChild.classList.toggle("closed"),btf.isHidden($nextEle[$nextEle.length-1])?$nextEle.forEach(e=>{e.style.display="block"}):$nextEle.forEach(e=>{e.style.display="none"})},highlightToolsFn=function(e){const $target=e.target.classList;$target.contains("expand")?highlightShrinkFn(this):$target.contains("copy-button")&&highlightCopyFn(this)},expandCode=function(){this.classList.toggle("expand-done")};function createEle(lang,item,service){const fragment=document.createDocumentFragment();if(isShowTool){const hlTools=document.createElement("div");hlTools.className=`highlight-tools ${highlightShrinkClass}`,hlTools.innerHTML=highlightShrinkEle+lang+highlightCopyEle,hlTools.addEventListener("click",highlightToolsFn),fragment.appendChild(hlTools)}if(highlightHeightLimit&&item.offsetHeight>highlightHeightLimit+30){const ele=document.createElement("div");ele.className="code-expand-btn",ele.innerHTML='<i class="fas fa-angle-double-down"></i>',ele.addEventListener("click",expandCode),fragment.appendChild(ele)}"hl"===service?item.insertBefore(fragment,item.firstChild):item.parentNode.insertBefore(fragment,item)}isHighlightLang?isPrismjs?$figureHighlight.forEach((function(item){const langName=item.getAttribute("data-language")?item.getAttribute("data-language"):"Code",highlightLangEle=`<div class="code-lang">${langName}</div>`;btf.wrap(item,"figure",{class:"highlight"}),createEle(highlightLangEle,item)})):$figureHighlight.forEach((function(item){let langName=item.getAttribute("class").split(" ")[1];"plain"!==langName&&void 0!==langName||(langName="Code");const highlightLangEle=`<div class="code-lang">${langName}</div>`;createEle(highlightLangEle,item,"hl")})):isPrismjs?$figureHighlight.forEach((function(item){btf.wrap(item,"figure",{class:"highlight"}),createEle("",item)})):$figureHighlight.forEach((function(item){createEle("",item,"hl")}))};function addPhotoFigcaption(){document.querySelectorAll("#article-container img").forEach((function(item){const parentEle=item.parentNode,altValue=item.title||item.alt;if(altValue&&!parentEle.parentNode.classList.contains("justified-gallery")){const ele=document.createElement("div");ele.className="img-alt is-center",ele.textContent=altValue,parentEle.insertBefore(ele,item.nextSibling)}}))}const runLightbox=()=>{btf.loadLightbox(document.querySelectorAll("#article-container img:not(.no-lightbox)"))},runJustifiedGallery=function(ele){if(ele.forEach(item=>{const $imgList=item.querySelectorAll("img");$imgList.forEach(i=>{const dataLazySrc=i.getAttribute("data-lazy-src");dataLazySrc&&(i.src=dataLazySrc),btf.wrap(i,"div",{class:"fj-gallery-item"})})}),window.fjGallery)return void setTimeout(()=>{btf.initJustifiedGallery(ele)},100);const newEle=document.createElement("link");newEle.rel="stylesheet",newEle.href=GLOBAL_CONFIG.source.justifiedGallery.css,document.body.appendChild(newEle),getScript(`${GLOBAL_CONFIG.source.justifiedGallery.js}`).then(()=>{btf.initJustifiedGallery(ele)})},scrollFn=function(){const $rightside=document.getElementById("rightside"),innerHeight=window.innerHeight+56;if(document.body.scrollHeight<=innerHeight)return void($rightside.style.cssText="opacity: 1; transform: translateX(-58px)");function scrollDirection(currentTop){const result=currentTop>initTop;return initTop=currentTop,result}let initTop=0,isChatShow=!0;const $header=document.getElementById("page-header"),isChatBtnHide="function"==typeof chatBtnHide,isChatBtnShow="function"==typeof chatBtnShow,scrollTask=btf.throttle(()=>{const currentTop=window.scrollY||document.documentElement.scrollTop,isDown=scrollDirection(currentTop);currentTop>56?(isDown?($header.classList.contains("nav-visible")&&$header.classList.remove("nav-visible"),isChatBtnShow&&!0===isChatShow&&(chatBtnHide(),isChatShow=!1)):($header.classList.contains("nav-visible")||$header.classList.add("nav-visible"),isChatBtnHide&&!1===isChatShow&&(chatBtnShow(),isChatShow=!0)),$header.classList.add("nav-fixed"),"0"===window.getComputedStyle($rightside).getPropertyValue("opacity")&&($rightside.style.cssText="opacity: 0.8; transform: translateX(-58px)")):(0===currentTop&&$header.classList.remove("nav-fixed","nav-visible"),$rightside.style.cssText="opacity: ''; transform: ''"),document.body.scrollHeight<=innerHeight&&($rightside.style.cssText="opacity: 0.8; transform: translateX(-58px)")},200);window.scrollCollect=scrollTask,window.addEventListener("scroll",scrollCollect)},scrollFnToDo=function(){const isToc=GLOBAL_CONFIG_SITE.isToc,isAnchor=GLOBAL_CONFIG.isAnchor,$article=document.getElementById("article-container");if(!$article||!isToc&&!isAnchor)return;let $tocLink,$cardToc,scrollPercent,autoScrollToc,isExpand;if(isToc){const $cardTocLayout=document.getElementById("card-toc");$cardToc=$cardTocLayout.getElementsByClassName("toc-content")[0],$tocLink=$cardToc.querySelectorAll(".toc-link");const $tocPercentage=$cardTocLayout.querySelector(".toc-percentage");isExpand=$cardToc.classList.contains("is-expand"),scrollPercent=currentTop=>{const docHeight=$article.clientHeight,winHeight=document.documentElement.clientHeight,headerHeight=$article.offsetTop,contentMath=docHeight>winHeight?docHeight-winHeight:document.documentElement.scrollHeight-winHeight,scrollPercent=(currentTop-headerHeight)/contentMath,scrollPercentRounded=Math.round(100*scrollPercent),percentage=scrollPercentRounded>100?100:scrollPercentRounded<=0?0:scrollPercentRounded;$tocPercentage.textContent=percentage},window.mobileToc={open:()=>{$cardTocLayout.style.cssText="animation: toc-open .3s; opacity: 1; right: 55px"},close:()=>{$cardTocLayout.style.animation="toc-close .2s",setTimeout(()=>{$cardTocLayout.style.cssText="opacity:''; animation: ''; right: ''"},100)}},$cardToc.addEventListener("click",e=>{e.preventDefault();const target=e.target.classList;if(target.contains("toc-content"))return;const $target=target.contains("toc-link")?e.target:e.target.parentElement;btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI($target.getAttribute("href")).replace("#",""))),300),window.innerWidth<900&&window.mobileToc.close()}),autoScrollToc=item=>{const activePosition=item.getBoundingClientRect().top,sidebarScrollTop=$cardToc.scrollTop;activePosition>document.documentElement.clientHeight-100&&($cardToc.scrollTop=sidebarScrollTop+150),activePosition<100&&($cardToc.scrollTop=sidebarScrollTop-150)}}const list=$article.querySelectorAll("h1,h2,h3,h4,h5,h6");let detectItem="";const findHeadPosition=function(top){if(0===top)return!1;let currentId="",currentIndex="";if(list.forEach((function(ele,index){if(top>btf.getEleTop(ele)-80){const id=ele.id;currentId=id?"#"+encodeURI(id):"",currentIndex=index}})),detectItem!==currentIndex&&(isAnchor&&btf.updateAnchor(currentId),detectItem=currentIndex,isToc)){if($cardToc.querySelectorAll(".active").forEach(i=>{i.classList.remove("active")}),""===currentId)return;const currentActive=$tocLink[currentIndex];if(currentActive.classList.add("active"),setTimeout(()=>{autoScrollToc(currentActive)},0),isExpand)return;let parent=currentActive.parentNode;for(;!parent.matches(".toc");parent=parent.parentNode)parent.matches("li")&&parent.classList.add("active")}};window.tocScrollFn=function(){return btf.throttle((function(){const currentTop=window.scrollY||document.documentElement.scrollTop;isToc&&scrollPercent(currentTop),findHeadPosition(currentTop)}),100)()},window.addEventListener("scroll",tocScrollFn)},rightSideFn_switchReadMode=()=>{const $body=document.body;$body.classList.add("read-mode");const newEle=document.createElement("button");function clickFn(){$body.classList.remove("read-mode"),newEle.remove(),newEle.removeEventListener("click",clickFn)}newEle.type="button",newEle.className="fas fa-sign-out-alt exit-readmode",$body.appendChild(newEle),newEle.addEventListener("click",clickFn)},rightSideFn_switchDarkMode=()=>{const nowMode="dark"===document.documentElement.getAttribute("data-theme")?"dark":"light";"light"===nowMode?(activateDarkMode(),saveToLocal.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),saveToLocal.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),"function"==typeof utterancesTheme&&utterancesTheme(),"function"==typeof changeGiscusTheme&&changeGiscusTheme(),"object"==typeof FB&&window.loadFBComment&&window.loadFBComment(),"function"==typeof runMermaid&&window.runMermaid()},rightSideFn_showOrHideBtn=e=>{const rightsideHideClassList=document.getElementById("rightside-config-hide").classList;rightsideHideClassList.toggle("show"),e.classList.contains("show")&&(rightsideHideClassList.add("status"),setTimeout(()=>{rightsideHideClassList.remove("status")},300)),e.classList.toggle("show")},rightSideFn_scrollToTop=()=>{btf.scrollToDest(0,500)},rightSideFn_hideAsideBtn=()=>{const $htmlDom=document.documentElement.classList;$htmlDom.contains("hide-aside")?saveToLocal.set("aside-status","show",2):saveToLocal.set("aside-status","hide",2),$htmlDom.toggle("hide-aside")},rightSideFn_runMobileToc=()=>{"0"===window.getComputedStyle(document.getElementById("card-toc")).getPropertyValue("opacity")?window.mobileToc.open():window.mobileToc.close()};document.getElementById("rightside").addEventListener("click",(function(e){const $target=e.target.id?e.target:e.target.parentNode;switch($target.id){case"go-up":rightSideFn_scrollToTop();break;case"rightside_config":rightSideFn_showOrHideBtn($target);break;case"mobile-toc-button":rightSideFn_runMobileToc();break;case"readmode":rightSideFn_switchReadMode();break;case"darkmode":rightSideFn_switchDarkMode();break;case"hide-aside-btn":rightSideFn_hideAsideBtn()}}));const clickFnOfSubMenu=()=>{document.querySelectorAll("#sidebar-menus .site-page.group").forEach((function(item){item.addEventListener("click",(function(){this.classList.toggle("hide")}))}))},addCopyright=()=>{const copyright=GLOBAL_CONFIG.copyright;document.body.oncopy=e=>{let textFont;e.preventDefault();const copyFont=window.getSelection(0).toString();return textFont=copyFont.length>copyright.limitCount?copyFont+"\n\n\n"+copyright.languages.author+"\n"+copyright.languages.link+window.location.href+"\n"+copyright.languages.source+"\n"+copyright.languages.info:copyFont,e.clipboardData?e.clipboardData.setData("text",textFont):window.clipboardData.setData("text",textFont)}},addRuntime=()=>{const $runtimeCount=document.getElementById("runtimeshow");if($runtimeCount){const publishDate=$runtimeCount.getAttribute("data-publishDate");$runtimeCount.innerText=btf.diffDate(publishDate)+" "+GLOBAL_CONFIG.runtime}},addLastPushDate=()=>{const $lastPushDateItem=document.getElementById("last-push-date");if($lastPushDateItem){const lastPushDate=$lastPushDateItem.getAttribute("data-lastPushDate");$lastPushDateItem.innerText=btf.diffDate(lastPushDate,!0)}},addTableWrap=()=>{const $table=document.querySelectorAll("#article-container :not(.highlight) > table, #article-container > table");$table.length&&$table.forEach(item=>{btf.wrap(item,"div",{class:"table-wrap"})})},clickFnOfTagHide=function(){const $hideInline=document.querySelectorAll("#article-container .hide-button");$hideInline.length&&$hideInline.forEach((function(item){item.addEventListener("click",(function(e){const $this=this;this.classList.add("open");const $fjGallery=this.nextElementSibling.querySelectorAll(".fj-gallery");$fjGallery.length&&btf.initJustifiedGallery($fjGallery)}))}))},tabsFn_clickFnOfTabs=function(){document.querySelectorAll("#article-container .tab > button").forEach((function(item){item.addEventListener("click",(function(e){const $this=this,$tabItem=$this.parentNode;if(!$tabItem.classList.contains("active")){const $tabContent=$tabItem.parentNode.nextElementSibling,$siblings=btf.siblings($tabItem,".active")[0];$siblings&&$siblings.classList.remove("active"),$tabItem.classList.add("active");const tabId=$this.getAttribute("data-href").replace("#",""),childList=[...$tabContent.children];childList.forEach(item=>{item.id===tabId?item.classList.add("active"):item.classList.remove("active")});const $isTabJustifiedGallery=$tabContent.querySelectorAll(`#${tabId} .fj-gallery`);$isTabJustifiedGallery.length>0&&btf.initJustifiedGallery($isTabJustifiedGallery)}}))}))},tabsFn_backToTop=()=>{document.querySelectorAll("#article-container .tabs .tab-to-top").forEach((function(item){item.addEventListener("click",(function(){btf.scrollToDest(btf.getEleTop(btf.getParents(this,".tabs")),300)}))}))},toggleCardCategory=function(){const $cardCategory=document.querySelectorAll("#aside-cat-list .card-category-list-item.parent i");$cardCategory.length&&$cardCategory.forEach((function(item){item.addEventListener("click",(function(e){e.preventDefault();const $this=this;this.classList.toggle("expand");const $parentEle=this.parentNode.nextElementSibling;btf.isHidden($parentEle)?$parentEle.style.display="block":$parentEle.style.display="none"}))}))},switchComments=function(){let switchDone=!1;const $switchBtn=document.querySelector("#comment-switch > .switch-btn");$switchBtn&&$switchBtn.addEventListener("click",(function(){this.classList.toggle("move"),document.querySelectorAll("#post-comment > .comment-wrap > div").forEach((function(item){btf.isHidden(item)?item.style.cssText="display: block;animation: tabshow .5s":item.style.cssText="display: none;animation: ''"})),switchDone||"function"!=typeof loadOtherComment||(switchDone=!0,loadOtherComment())}))},addPostOutdateNotice=function(){const data=GLOBAL_CONFIG.noticeOutdate,diffDay=btf.diffDate(GLOBAL_CONFIG_SITE.postUpdate);if(diffDay>=data.limitDay){const ele=document.createElement("div");ele.className="post-outdate-notice",ele.textContent=data.messagePrev+" "+diffDay+" "+data.messageNext;const $targetEle=document.getElementById("article-container");"top"===data.position?$targetEle.insertBefore(ele,$targetEle.firstChild):$targetEle.appendChild(ele)}},lazyloadImg=()=>{window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src"})},relativeDate=function(selector){selector.forEach(item=>{const $this=item,timeVal=$this.getAttribute("datetime");$this.innerText=btf.diffDate(timeVal,!0),$this.style.display="inline"})},unRefreshFn=function(){window.addEventListener("resize",()=>{adjustMenu(!1),btf.isHidden(document.getElementById("toggle-menu"))&&mobileSidebarOpen&&sidebarFn_close()}),document.getElementById("menu-mask").addEventListener("click",e=>{sidebarFn_close()}),clickFnOfSubMenu(),GLOBAL_CONFIG.islazyload&&lazyloadImg(),void 0!==GLOBAL_CONFIG.copyright&&addCopyright()};window.refreshFn=function(){initAdjust(),GLOBAL_CONFIG_SITE.isPost?(void 0!==GLOBAL_CONFIG.noticeOutdate&&addPostOutdateNotice(),GLOBAL_CONFIG.relativeDate.post&&relativeDate(document.querySelectorAll("#post-meta time"))):(GLOBAL_CONFIG.relativeDate.homepage&&relativeDate(document.querySelectorAll("#recent-posts time")),GLOBAL_CONFIG.runtime&&addRuntime(),addLastPushDate(),toggleCardCategory()),scrollFnToDo(),GLOBAL_CONFIG_SITE.isHome&&scrollDownInIndex(),addHighlightTool(),GLOBAL_CONFIG.isPhotoFigcaption&&addPhotoFigcaption(),scrollFn();const $jgEle=document.querySelectorAll("#article-container .fj-gallery");$jgEle.length&&runJustifiedGallery($jgEle),runLightbox(),addTableWrap(),clickFnOfTagHide(),tabsFn_clickFnOfTabs(),tabsFn_backToTop(),switchComments(),document.getElementById("toggle-menu").addEventListener("click",()=>{sidebarFn_open()})},refreshFn(),unRefreshFn()}));